The following data was generated by Copilot.

[REMOVE THIS] https://copilot.microsoft.com/shares/XVFsjJMbdMefVPdPHtGf9

# TLV encoding

## Valid data

| # | Test method   | Hex Data          | Description |
|---|---------------|-------------------|-------------|
| 1 | TLV_Correct01 | 01 01 FF          | Tag=0x01, length=1, value=0xFF
| 2 | TLV_Correct02 | 9F 1A 02 12 34    | Tag=9F1A, length=2, value=0x1234
| 3 | TLV_Correct03 | DF 00 03 AB CD EF | Tag=DF00, length=3, value=0xABCDEF
| 4 | TLV_Correct03 | 5C 03 01 02 03    | Tag=5C, length=3, value=0x010203
| 5 | TLV_Correct05 | 6F 00             | Tag=6F, length=0, no value


## Invalid data

01 Missing length and value.

9F 1A 02 12 Declared length 2 but only one value byte.

5F Single-octet tag marker 5F requires a following tag octet.

04 81 Length octet 81 indicates one subsequent length byte, but length byte and value are missing.

DF 00 05 AA BB Declared length 5 but only 2 value bytes provided.


BER encoding
============

Valid data
----------

| # | Test method  | Hex data                                              | Description                                                            |
|---|--------------|-------------------------------------------------------|------------------------------------------------------------------------|
| 1 |              | `30 07 02 01 A9 04 02 48 69`                          | SEQUENCE { INTEGER 169, OCTET STRING "Hi" }                            |
| 2 |              | `30 09 30 06 02 01 01 02 01 02 01 01 FF`              | SEQUENCE { SEQUENCE { INTEGER 1, INTEGER 2 }, BOOLEAN TRUE }           |
| 3 |              | `30 0B 04 05 48 65 6C 6C 6F 30 06 02 01 0A 02 01 14`  | SEQUENCE { OCTET STRING "Hello", SEQUENCE { INTEGER 10, INTEGER 20 } } |
| 4 |              | `30 0B A0 09 02 01 05 02 01 0A 02 01 0F`              | SEQUENCE { [0] { INTEGER 5, INTEGER 10, INTEGER 15 } }                 |
| 5 |              | `30 0A 31 08 02 02 00 64 02 02 00 C8`                 | SEQUENCE { SET { INTEGER 100, INTEGER 200 } }                          |

Invalid data
------------

| # | Test method | Hex data                              | Description                                                            |
|---|-------------|---------------------------------------|------------------------------------------------------------------------|
| 1 |             | `30 09 30 06 02 01 01 02 01`          | Il SEQUENCE esterno dichiara lunghezza 9, ma il sottosequence interno è troncato (manca almeno un byte di valore).        |
| 2 |             | `30 08 30 07 02 01 01 02 01 02 01 02` | Disallineamento tra lunghezza dichiarata (8) e byte effettivi (9) all’interno della struttura annidata.                   |
| 3 |             | `04 80 61 62 63`                      | OCTET STRING primitiva con forma indefinita non permessa in BER (soltanto le forme costruttive possono usare indefinito). |
| 4 |             | `1F 81 01 00`                         | Tag multi-octet: il marker 1F richiede almeno un byte tag-number, ma l’encoding è incompleto.                             |
| 5 |             | `30 02 02 81 80`                      | INTEGER con forma lunga minimale non rispettata: 81 80 indica lunghezza 128 ma senza ulteriori valori.                    |

DER encoding
============

Valid data
----------

#	Hex Data	Descrizione
1	30 07 02 01 09 04 02 48 69	SEQUENCE { INTEGER 9, OCTET STRING "Hi" }
2	30 08 30 04 02 01 01 02 01 02 01 01 FF	SEQUENCE { SEQUENCE {1, 2}, BOOLEAN TRUE } – tutte le lunghezze in forma breve
3	30 0B 04 05 48 65 6C 6C 6F 30 06 02 01 0A 02 01 14	SEQUENCE { "Hello", SEQUENCE {10, 20} }
4	30 0B A0 09 02 01 05 02 01 0A 02 01 0F	SEQUENCE { [0] COSTRUTTO {5, 10, 15} }
5	30 0A 31 08 02 02 00 64 02 02 00 C8	SEQUENCE { SET {100, 200} } – SET ordinato in ordine crescente dei valori

Invalid data
------------

02 02 00 7F INTEGER con zero di padding non necessario: in DER vanno eliminate le zeri superflue (dovrebbe essere 02 01 7F).

04 81 03 41 42 43 OCTET STRING con forma lunga non necessaria: per lunghezze ≤127 va usata la forma breve.

30 80 02 01 01 00 00 SEQUENCE con lunghezza indefinita non ammessa in DER (solo BER e CER la supportano).

A0 01 FF Context-specific [0] in forma primitiva: in DER, un tag costruttivo deve essere indicato come costruttivo con bit appropriato.

01 02 FF 00 BOOLEAN con lunghezza diversa da 1 (in DER BOOLEAN ha sempre lunghezza 1).

CER encoding
============

Valid data
----------


#	Hex Data	Descrizione
1	30 80 │ SEQUENCE indefinita
30 80 │ nested SEQUENCE indefinita
04 80 │ OCTET STRING costruttivo indefinito
04 02 61 62 │ chunk "ab"
04 02 63 64 │ chunk "cd"
00 00 │ EOC per OCTET STRING
00 00 │ EOC per SEQUENCE interno
02 01 01 │ INTEGER 1
00 00 │ EOC per SEQUENCE esterno
2	30 03 02 01 01	SEQUENCE DEFINITA { INTEGER 1 }
3	04 80 04 02 61 62 00 00	OCTET STRING costruttivo indefinito con un chunk "ab"
4	A0 80 02 01 05 00 00	[0] indefinito con INTEGER 5
5	31 80 02 01 0A │ SET indefinito
04 80 04 02 6F 6B 00 00 │ OCTET STRING costruttivo indefinito con "ok"
00 00 │ EOC per SET


Invalid data
------------

02 80 01 01 00 00 INTEGER in forma indefinita non ammessa in CER (solo costrutti scelti possono essere indefiniti).

04 80 04 02 61 62 00 00 OCTET STRING primitiva in forma indefinita (in CER le primitive non possono usare indefinito).

04 82 04 61 62 63 64 00 00 Chunk di OCTET STRING con lunghezza 0x0461 (1121) supera il massimo 1000 previsto da CER.

30 80 02 01 01 00 00 SEQUENCE indefinita senza doppio EOC: serve un EOC per il SEQUENCE interno e uno per l’esterno.

04 83 03 E9 … 00 00 Chunk length long-form non minimale e valore di lunghezza superiore a 1000 (0x03E9 = 1001) non consentito.




